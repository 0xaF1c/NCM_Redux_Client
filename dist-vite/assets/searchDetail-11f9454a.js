import{ah as _,d as k,b4 as w,r as i,b3 as q,b0 as b,e as C,an as T,ao as x,at as B,ae as I,ap as S,ai as U}from"./index-7904e8ad.js";import{p as D,f as H}from"./formatPlaylist-9c206ac5.js";import{u as N}from"./use-loading-bar-43e6022e.js";import"./musicLikeBtn.vue_vue_type_script_setup_true_lang-a46553f4.js";import"./Ellipsis-c692ea86.js";import"./PageHeader-e12a2bfa.js";import"./text-4eec9490.js";import"./Grid-c77da12a.js";const P=(u,r)=>_.get("/cloudsearch",{params:{keywords:u,type:r}}),G=k({__name:"searchDetail",setup(u){const{start:r,error:m,finish:d}=N();r();const t=w(),l=i(),s=q({id:-1,name:"搜索结果 - "+t.query.keywords,coverImgUrl:"",userId:0,createTime:0,playCount:-1,trackCount:-1,tags:[],description:"这只是你的搜索结果"}),{run:y,loading:f,data:v}=b(P,{onSuccess(){var e;const a=v.value.data.result.songs;if(a===void 0)s.name="搜索结果 - 什么都没搜到 关于 - "+t.query.keywords,m();else{const c=H(a);o.value=c.slice(0,n.value),s.coverImgUrl=(e=c[0])==null?void 0:e.album.picUrl,l.value=c,d()}}}),p=()=>{r(),y(t.query.keywords,1),s.name="搜索结果 - "+t.query.keywords};p(),C(()=>t.query,()=>{p()});const o=i(),n=i(20),g=a=>a.scrollHeight-a.clientHeight,h=a=>{var e;((e=a.currentTarget)==null?void 0:e.scrollTop)==g(a.currentTarget)&&f.value==!1&&(n.value+=10,o.value=l.value.slice(0,n.value))};return(a,e)=>(I(),T(B(U),{"on-scroll":h},{default:x(()=>[S(D,{"all-playlist":l.value,"render-playlist":o.value,"playlist-matadata":s},null,8,["all-playlist","render-playlist","playlist-matadata"])]),_:1}))}});export{G as default};
